<ion-content [fullscreen]="true">
  <app-resident-header [is_client]="true"  [text]="'Quick Dials'" [text_second]="''" />
  <div class="flex flex-col justify-between mt-2 ml-3">
    <ion-icon name="arrow-back-circle" size="large" class="text-[var(--ion-color-primary)] size-12"
      (click)="onBack()"></ion-icon>
  </div>
  <!-- CONTENT -->
  <div class="flex flex-col relative mx-4 mt-4" *ngIf="isMain" @fadeInOut>
    <div>
      <div
        class="flex flex-row w-full items-center h-14 rounded-full bg-[var(--ion-color-secondary)] justify-between px-4">
        <span class="text-lg font-bold">Quick Dials Settings</span>
        <div class="w-10 h-10 rounded-full bg-[var(--ion-color-primary)] flex flex-col justify-center items-center mr-2"
          (click)="onSetting()">
          <fa-icon [icon]="faSetting" class="flex flex-col justify-center items-center text-xl text-white"></fa-icon>
        </div>
      </div>
      <!-- <div class="flex flex-row w-full px-4 space-x-2">
        <div class="w-full mt-2 items-center flex flex-row">
          <input id="all_contact" (change)="checkBoxChange(true)" type="checkbox"
            class="rounded text-[var(--ion-color-primary)]" [(ngModel)]="isAllContacts">
          <label for="all_contact" class="ml-3 text-sm">All Contacts</label>
        </div>
        <div class="w-full mt-2 items-center">
          <input id="my_contact" (change)="checkBoxChange(false)" type="checkbox"
            class="rounded text-[var(--ion-color-primary)]" [(ngModel)]="isMyContacts">
          <label for="my_contact" class="ml-3 text-sm">My Contacts</label>
        </div>
      </div> -->

    </div>
    <div *ngIf="isLoading" class="flex justify-center items-center h-20">
      <ion-spinner name="dots"></ion-spinner>
    </div>
    <div class="flex flex-col mt-3 mb-24" *ngIf="!isLoading">
      <div class="space-y-3" *ngIf="sortContact.length > 0; else noContact">
        <div class="flex flex-col" *ngFor="let header of sortContact">
          <div class="text-base font-semibold text-gray-600 text-start ml-4">{{ header.name }}</div>
          <div class="flex flex-col w-full space-y-2 mt-3">
            <div
              class="flex flex-row w-full items-center h-14 rounded-full bg-[var(--ion-color-secondary)] justify-between px-4"
              *ngFor="let contact of header.data">
              <span class="text-lg font-bold">{{ contact.name }}</span>
              <a [href]="'tel:' + contact.contact_number">
                <div
                  class="w-10 h-10 rounded-full bg-[var(--ion-color-primary)] flex flex-col justify-center items-center mr-2">
                  <fa-icon [icon]="faPhone"
                    class="flex flex-col justify-center items-center text-xl text-white"></fa-icon>
                </div>
              </a>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <div class="flex flex-col relative mx-4 mt-2" *ngIf="isSetting" @fadeInOut>
    <div class="flex flex-row justify-center space-x-3 w-full" *ngIf="isEdit" @fadeInOut>
      <div class="w-full">
        <app-visitor-button [text]="'Edit My Contacts'"
          [extraClass]="'w-full leading-none cw-4:text-sm ' + (isEdit ? 'bg-[var(--ion-color-primary)] text-white': 'bg-[#D0D0D0] text-[#757575]')"
          (click)="toggleShowEdit()"></app-visitor-button>
      </div>
      <div class="w-full">
        <app-visitor-button [text]="'Add New Contact'"
          [extraClass]="'w-full leading-none cw-4:text-sm ' + (!isEdit ? 'bg-[var(--ion-color-primary)] text-white': 'bg-[#D0D0D0] text-[#757575]')"
          (click)="toggleShowAdd()"></app-visitor-button>
      </div>
    </div>
    <div *ngIf="isEdit" @fadeInOut>
      <div *ngIf="isLoading" class="flex justify-center items-center h-20">
        <ion-spinner name="dots"></ion-spinner>
      </div>
      <div *ngIf="!isLoading">
        <div class="flex flex-col relative space-y-3 mt-6 mb-24" *ngIf="sortContact.length > 0; else noContact">
          <div class="flex flex-col" *ngFor="let header of sortContact">
            <div class="text-base font-semibold text-gray-600 text-start ml-4">{{ header.name }}</div>
            <div class="flex flex-col w-full space-y-2 mt-3">
              <div
                class="flex flex-row w-full items-center h-16 rounded-full bg-[var(--ion-color-secondary)] justify-between px-6"
                *ngFor="let contact of header.data">
                <span class="text-lg font-bold w-[70%]">{{ contact.name }}</span>
                <div class="flex flex-col justify-center items-center mr-3 w-[30%] space-y-1 ml-1">
                  <button class="w-full rounded-md font-bold text-base text-white bg-[var(--ion-color-primary)]"
                    (click)="onEditButton(contact)">Edit</button>
                  <button class="w-full rounded-md font-bold text-base text-white bg-[var(--ion-color-danger)]"
                    (click)="onDeleteClick(contact)">Delete</button>
                </div>
              </div>
            </div>
          </div>
  
        </div>
      </div>
    </div>

    <div class="flex flex-col relative mx-4" *ngIf="isAdd" @fadeInOut>
      <div class="flex flex-col justify-between mt-4 space-y-2 w-full">
        <div class="w-full flex flex-col justify-center items-center">
          <input #fileInput type="file" class="hidden" (change)="onFileChange($event)" accept="image/*">
          <div class="w-24 h-24 rounded-full flex flex-col justify-center items-center bg-[var(--ion-color-secondary)]"
            (click)="onImageClick()">
            <img *ngIf="!contactForm.image" src="assets/icon/exc-client/add_image.png" alt="Contact Picture"
              class="w-12 h-12 object-cover rounded-2xl">
            <img *ngIf="contactForm.image" [src]="functionMain.getImage(contactForm.image)" alt="Contact Picture"
              class="w-24 h-24 object-cover rounded-full">
          </div>
          <label class="text-xl font-bold mt-2" (click)="onImageClick()">Add Image</label>
        </div>
        <div class="w-full">
          <app-text-input [labelResidentText]="'Name'" [labelResidentClass]="'text-base font-bold mb-[-2px]'"
            [id]="'client_contact_add_name'" [placeholder]="'Lana Ray'" [customClasses]="{'w-full items-start': true}"
            [type]="'text'"
            [customInputClasses]="{'border': true, 'w-full': true, 'rounded': true, 'py-2': true, 'px-3': true, 'outline-[#BDBDBD]': true, 'h-14': true, 'text-base': true}"
            [(ngModel)]="contactForm.name"></app-text-input>
        </div>
        <div class="w-full">
          <app-vms-contact-input [(value)]="contactForm.contact_number" [id]="'client_contact_add_contact_number'"
            [vmsPage]="false" [contactLabel]="'Mobile Number'" [labelClass]="'text-base'"
            [inputClass]="'border w-full rounded py-2 px-3 outline-[#BDBDBD] h-14 text-base'"></app-vms-contact-input>
        </div>
        <div class="flex flex-row justify start items-center">
          <input id="client_contact_add_close" name="client_contact_add_close" type="checkbox"
            class="rounded w-7 h-7 mt-1 text-[var(--ion-color-primary)]" [(ngModel)]="contactForm.is_add">
          <label class="text-base font-bold mt-1 ml-3" for="client_contact_add_close">Add to Resident App Quick
            Dials</label>
        </div>
        <div class="flex flex-row justify start items-center">
          <input id="client_contact_whatsapp" name="client_contact_whatsapp" type="checkbox"
            class="rounded w-7 h-7 mt-1 text-[var(--ion-color-primary)]" [(ngModel)]="contactForm.is_whatsapp">
          <label class="text-base font-bold mt-1 ml-3" for="client_contact_whatsapp">Allow Whatsapp</label>
        </div>
        <div class="w-full ">
          <button (click)="onSubmit()"
            class="bg-[var(--ion-color-primary)] text-white px-3 py-2 text-base rounded font-bold w-full mt-4 h-14">
            {{isCurrentEdit ? 'Edit Contact' : 'Add Contact'}}
          </button>
        </div>
      </div>
    </div>
    
  </div>
  <!-- ############################### -->
  <ng-template #noContact>
    <div class="w-full bg-transparent mt-8 text-center rounded-lg">
      <p class="text-gray-600">There are no contacts.....</p>
    </div>
  </ng-template>
  <app-bottom-nav-bar [clientRoute]="true"></app-bottom-nav-bar>
</ion-content>
<ion-content class="h-full ">

  <video id="remote-video" autoplay class="h-full w-full object-cover" [ngClass]="getRemoteCam() && !showMinimize ? '' : 'hidden'"></video>
  <video id="local-video" autoplay class="fixed bottom-28 h-48 w-32 object-cover right-4 hidden"></video>
  <div class="relative d-flex w-100 bg-white" [ngClass]="getRemoteCam() ? '' : 'h-full'" *ngIf="!showMinimize">
    <!-- Local video -->
    <div class="h-full w-full bg-white" [ngClass]="getRemoteCam() ? '' : 'pt-4 pb-48'">
      <div class="flex flex-col h-full justify-between items-center">
        <div class="flex flex-col justify-center w-full items-center" [ngClass]="getRemoteCam() ? 'fixed top-0 z[999] mt-5' : ''">
          <div class="w-full flex flex-row justify-start">
            <svg width="30px" height="30px" viewBox="0 0 24 24" class="ml-4" fill="#121212" xmlns="http://www.w3.org/2000/svg" (click)="actionMinimize()">
              <path d="M20.8571 9.75C21.2714 9.75 21.6071 9.41421 21.6071 9C21.6071 8.58579 21.2714 8.25 20.8571 8.25H16.8107L22.5303 2.53033C22.8232 2.23744 22.8232 1.76256 22.5303 1.46967C22.2374 1.17678 21.7626 1.17678 21.4697 1.46967L15.75 7.18934V3.14286C15.75 2.72864 15.4142 2.39286 15 2.39286C14.5858 2.39286 14.25 2.72864 14.25 3.14286V9C14.25 9.41421 14.5858 9.75 15 9.75H20.8571Z" fill="#1C274C"/>
              <path d="M3.14286 14.25C2.72864 14.25 2.39286 14.5858 2.39286 15C2.39286 15.4142 2.72864 15.75 3.14286 15.75H7.18934L1.46967 21.4697C1.17678 21.7626 1.17678 22.2374 1.46967 22.5303C1.76256 22.8232 2.23744 22.8232 2.53033 22.5303L8.25 16.8107V20.8571C8.25 21.2714 8.58579 21.6071 9 21.6071C9.41421 21.6071 9.75 21.2714 9.75 20.8571V15C9.75 14.5858 9.41421 14.25 9 14.25H3.14286Z" fill="#1C274C"/>
            </svg>
          </div>
          <span *ngIf="isReceiver" class="font-bold text-black mt-4">{{ getCallerName() }}</span>
          <span *ngIf="!isReceiver" class="font-bold text-black mt-4">{{ getReceiverName() }}</span>
          <ng-container *ngIf="audioStatus | async as status">
            <span *ngIf="status !== 'Audio connected'" class="text-black mt-2">{{ status }}</span>
            <span *ngIf="status === 'Audio connected'" class="text-black font-bold mt-2">{{ formattedTime }}</span>
          </ng-container>
        </div>
        <!-- <div class="rounded-full w-44 h-44 bg-[#333333] overflow-hidden flex items-center justify-center">
          <img [src]="getSenderProfilePic()" class="w-full h-full" *ngIf="isReceiver">
          <img [src]="getReceiverProfilePic()" class="w-full h-full" *ngIf="!isReceiver">
        </div> -->
        <div class="w-full flex flex-row justify-center" *ngIf="!getRemoteCam()">
          <img [src]="getSenderProfilePic()" class="max-w-1/2 max-h-40" *ngIf="isReceiver">
          <img [src]="getReceiverProfilePic()" class="max-w-1/2 max-h-40" *ngIf="!isReceiver">
        </div>
        <div></div>
      </div>
    </div>
    
    <!-- Remote video -->
    <div class="fixed bottom-0 z-[999] flex items-center justify-center w-full">
      <div class="w-11/12 bg-[#333333] mb-3 py-2 px-1 rounded-md text-[#ffffff] flex items-center justify-around">
        <!-- <div class="rounded-full w-14 h-14 bg-[#d3d3d3] flex items-center justify-center"(click)="toggleCam()">
          <svg *ngIf="!onCam" width="30px" height="30px" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path fill-rule="evenodd" clip-rule="evenodd" d="M3.70711 2.29289C3.31658 1.90237 2.68342 1.90237 2.29289 2.29289C1.90237 2.68342 1.90237 3.31658 2.29289 3.70711L3.47958 4.89379C2.57683 5.6272 2 6.74624 2 8V16C2 18.2091 3.79086 20 6 20H13C14.5123 20 15.8285 19.1608 16.5085 17.9227L20.2929 21.7071C20.6834 22.0976 21.3166 22.0976 21.7071 21.7071C22.0976 21.3166 22.0976 20.6834 21.7071 20.2929L3.70711 2.29289ZM22 15.7547C22 16.423 21.6945 16.9694 21.2452 17.3219C21.0728 17.4572 20.8307 17.4164 20.6757 17.2615L8.26777 4.85355C7.95278 4.53857 8.17587 4 8.62132 4H13C15.2091 4 17 5.79086 17 8V8.25466L18.6621 6.75879C19.9491 5.60045 22 6.51384 22 8.24538V15.7547Z" fill="#D32F2F"/>
          </svg>
          <svg *ngIf="onCam" width="30px" height="30px" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path fill-rule="evenodd" clip-rule="evenodd" d="M6 4C3.79086 4 2 5.79086 2 8V16C2 18.2091 3.79086 20 6 20H13C15.2091 20 17 18.2091 17 16V15.7454L18.6621 17.2412C19.9491 18.3996 22 17.4862 22 15.7547V8.24538C22 6.51384 19.9491 5.60045 18.6621 6.75879L17 8.25466V8C17 5.79086 15.2091 4 13 4H6Z" fill="#000000"/>
          </svg>
        </div> -->
        <div class="rounded-full w-14 h-14 bg-[#d3d3d3] flex items-center justify-center"(click)="toggleSpeaker()">
          <svg *ngIf="onSpeaker" width="30px" height="30px" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path d="M13 3.7446C13 3.27314 12.8728 2.50021 12.1657 2.14424C11.4151 1.76635 10.7163 2.19354 10.3623 2.51158L4.94661 7.43717H3C1.89543 7.43717 1 8.3326 1 9.43717L1.00001 14.6248C1.00001 15.7293 1.89544 16.6248 3.00001 16.6248H4.95001L10.3623 21.4891C10.7175 21.8081 11.416 22.2331 12.1656 21.8554C12.8717 21.4998 13 20.7286 13 20.2561V3.7446Z" fill="#000000"/>
            <path d="M17.336 3.79605L17.0952 3.72886C16.5633 3.58042 16.0117 3.89132 15.8632 4.42329L15.7289 4.90489C15.5804 5.43685 15.8913 5.98843 16.4233 6.13687L16.6641 6.20406C18.9551 6.84336 20.7501 9.14615 20.7501 12.0001C20.7501 14.854 18.9551 17.1568 16.6641 17.7961L16.4233 17.8632C15.8913 18.0117 15.5804 18.5633 15.7289 19.0952L15.8632 19.5768C16.0117 20.1088 16.5633 20.4197 17.0952 20.2713L17.336 20.2041C20.7957 19.2387 23.2501 15.8818 23.2501 12.0001C23.2501 8.11832 20.7957 4.76146 17.336 3.79605Z" fill="#000000"/>
            <path d="M16.3581 7.80239L16.1185 7.73078C15.5894 7.57258 15.0322 7.87329 14.874 8.40243L14.7308 8.88148C14.5726 9.41062 14.8733 9.96782 15.4024 10.126L15.642 10.1976C16.1752 10.3571 16.75 11.012 16.75 12C16.75 12.9881 16.1752 13.643 15.642 13.8024L15.4024 13.874C14.8733 14.0322 14.5726 14.5894 14.7308 15.1185L14.874 15.5976C15.0322 16.1267 15.5894 16.4274 16.1185 16.2692L16.3581 16.1976C18.1251 15.6693 19.25 13.8987 19.25 12C19.25 10.1014 18.1251 8.33068 16.3581 7.80239Z" fill="#000000"/>
          </svg>
          <svg *ngIf="!onSpeaker" width="30px" height="30px" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path d="M12.1657 2.14424C12.8728 2.50021 13 3.27314 13 3.7446V20.2561C13 20.7286 12.8717 21.4998 12.1656 21.8554C11.416 22.2331 10.7175 21.8081 10.3623 21.4891L4.95001 16.6248H3.00001C1.89544 16.6248 1.00001 15.7293 1.00001 14.6248L1 9.43717C1 8.3326 1.89543 7.43717 3 7.43717H4.94661L10.3623 2.51158C10.7163 2.19354 11.4151 1.76635 12.1657 2.14424Z" fill="#D32F2F"/>
            <path d="M21.8232 15.6767C21.4327 16.0673 20.7995 16.0673 20.409 15.6768L18.5 13.7678L16.591 15.6768C16.2005 16.0673 15.5673 16.0673 15.1768 15.6767L14.8233 15.3232C14.4327 14.9327 14.4327 14.2995 14.8233 13.909L16.7322 12L14.8232 10.091C14.4327 9.70044 14.4327 9.06727 14.8232 8.67675L15.1767 8.3232C15.5673 7.93267 16.2004 7.93267 16.591 8.32319L18.5 10.2322L20.409 8.32319C20.7996 7.93267 21.4327 7.93267 21.8233 8.3232L22.1768 8.67675C22.5673 9.06727 22.5673 9.70044 22.1768 10.091L20.2678 12L22.1767 13.909C22.5673 14.2995 22.5673 14.9327 22.1767 15.3232L21.8232 15.6767Z" fill="#D32F2F"/>
          </svg>
        </div>
        <div class="rounded-full w-14 h-14 bg-[#d3d3d3] flex items-center justify-center" (click)="toggleMic()">
          <svg *ngIf="onMic" width="30px" height="30px" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path d="M9.5 10.5V6.5C9.5 5.11929 10.6193 4 12 4C13.3807 4 14.5 5.11929 14.5 6.5V10.5C14.5 11.8807 13.3807 13 12 13C10.6193 13 9.5 11.8807 9.5 10.5Z" fill="#000000" stroke="#000000" stroke-width="2" stroke-linecap="round"/>
            <path d="M7.5 14C8.11508 16.1869 9.8033 17.5 12 17.5M12 17.5C14.1967 17.5 15.8849 16.1869 16.5 14M12 17.5V21" stroke="#000000" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
          </svg>
          <svg *ngIf="!onMic" width="30px" height="30px" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path d="M5 5L19 19" stroke="#D32F2F" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
            <path fill-rule="evenodd" clip-rule="evenodd" d="M9.68219 5.56134C10.0533 4.64576 10.9513 4 12 4C13.3807 4 14.5 5.11929 14.5 6.5V10.3792L9.68219 5.56134ZM12.7605 12.8822L9.5 9.62179V10.5C9.5 11.8807 10.6193 13 12 13C12.2651 13 12.5207 12.9587 12.7605 12.8822Z" fill="#D32F2F"/>
            <path d="M9.68219 5.56134L8.97509 6.26845L8.50647 5.79984L8.75544 5.18566L9.68219 5.56134ZM14.5 10.3792H15.5V12.7934L13.7929 11.0863L14.5 10.3792ZM12.7605 12.8822L13.4676 12.1751L14.6285 13.3361L13.0643 13.835L12.7605 12.8822ZM9.5 9.62179H8.5V7.20758L10.2071 8.91469L9.5 9.62179ZM8.75544 5.18566C9.27431 3.90569 10.5302 3 12 3V5C11.3723 5 10.8324 5.38583 10.6089 5.93702L8.75544 5.18566ZM12 3C13.933 3 15.5 4.567 15.5 6.5H13.5C13.5 5.67157 12.8284 5 12 5V3ZM15.5 6.5V10.3792H13.5V6.5H15.5ZM10.3893 4.85424L15.2071 9.67204L13.7929 11.0863L8.97509 6.26845L10.3893 4.85424ZM12.0533 13.5893L8.79289 10.3289L10.2071 8.91469L13.4676 12.1751L12.0533 13.5893ZM8.5 10.5V9.62179H10.5V10.5H8.5ZM12 14C10.067 14 8.5 12.433 8.5 10.5H10.5C10.5 11.3284 11.1716 12 12 12V14ZM13.0643 13.835C12.7274 13.9424 12.3695 14 12 14V12C12.1608 12 12.3139 11.975 12.4566 11.9295L13.0643 13.835Z" fill="#D32F2F"/>
            <path fill-rule="evenodd" clip-rule="evenodd" d="M8.46291 13.7293C8.31338 13.1976 7.76117 12.8878 7.22951 13.0373C6.69785 13.1869 6.38808 13.7391 6.5376 14.2707C7.17394 16.5333 8.82364 18.063 11.0003 18.42V21C11.0003 21.5523 11.448 22 12.0003 22C12.5525 22 13.0003 21.5523 13.0003 21V18.42C13.7841 18.2914 14.4996 18.0108 15.124 17.5986L13.6608 16.1355C13.1713 16.3753 12.6119 16.5 12.0003 16.5C10.2727 16.5 8.9625 15.5056 8.46291 13.7293ZM15.7806 13.3054C16.0279 13.0495 16.4044 12.9342 16.771 13.0373C17.3027 13.1869 17.6124 13.7391 17.4629 14.2707C17.4108 14.456 17.3519 14.6363 17.2865 14.8114L15.7806 13.3054Z" fill="#D32F2F"/>
          </svg>
        </div>
        <div class="rounded-full w-14 h-14 bg-[#d3d3d3] flex items-center justify-center" (click)="openIntercomGate()" *ngIf="getIsFromIntercom()">
          <svg width="30px" height="30px" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path fill-rule="evenodd" clip-rule="evenodd" d="M9 0L3 2V14H1V16H15V14H13V2H11V14H9V0ZM6.75 9C7.16421 9 7.5 8.55229 7.5 8C7.5 7.44772 7.16421 7 6.75 7C6.33579 7 6 7.44772 6 8C6 8.55229 6.33579 9 6.75 9Z" fill="#000000"/>
          </svg>
        </div>
        <div class="rounded-full w-14 h-14 bg-[#D32F2F] flex items-center justify-center" (click)="endCall()">
          <svg fill="#d3d3d3" width="30px" height="30px" viewBox="0 0 56 56" xmlns="http://www.w3.org/2000/svg"><path d="M 28.0235 17.6055 C 17.8751 17.6055 8.3361 19.7383 3.5783 24.4961 C 1.4454 26.6524 .3439 29.2539 .4845 32.3945 C .5782 34.2929 1.1642 35.9805 2.2657 37.0820 C 3.1095 37.9258 4.2345 38.3945 5.5704 38.1836 L 14.2657 36.7070 C 15.5783 36.4961 16.4923 36.0976 17.0783 35.4883 C 17.8517 34.7383 18.0861 33.6133 18.0861 32.1367 L 18.1095 29.7695 C 18.1095 29.3945 18.2735 29.1133 18.4845 28.8789 C 18.7188 28.5976 19.0704 28.4805 19.3283 28.4102 C 20.9220 28.0351 24.1798 27.6836 28.0235 27.6836 C 31.8908 27.6836 35.1251 27.9648 36.7188 28.4336 C 36.9532 28.5039 37.2814 28.6445 37.5392 28.8789 C 37.7735 29.1133 37.9142 29.3711 37.9142 29.7461 L 37.9376 32.1367 C 37.9610 33.6133 38.1954 34.7383 38.9454 35.4883 C 39.5548 36.0976 40.4688 36.4961 41.7814 36.7070 L 50.3593 38.1602 C 51.7422 38.3945 52.9144 37.9024 53.8283 37.0117 C 54.9299 35.9336 55.5390 34.2695 55.5861 32.3711 C 55.6561 29.2070 54.4609 26.6055 52.3518 24.4961 C 47.5705 19.7383 38.1720 17.6055 28.0235 17.6055 Z"/></svg>
        </div>
      </div>
    </div>

    
  </div>

  <div class="w-full h-full draggable-modal" *ngIf="showMinimize">
    <div class="flex flex-row justify-between items-center w-full h-full drag-handle">
      <div class="w-1/3 flex flex-row justify-center">
        <div class="rounded-full w-14 h-14 bg-[#d3d3d3] flex items-center justify-center" (click)="actionMinimize()">
          <svg width="30px" height="30px" viewBox="0 0 24 24" fill="#d3d3d3" xmlns="http://www.w3.org/2000/svg">
            <path d="M16.1429 1.25C15.7286 1.25 15.3929 1.58579 15.3929 2C15.3929 2.41421 15.7286 2.75 16.1429 2.75H20.1893L14.4697 8.46967C14.1768 8.76256 14.1768 9.23744 14.4697 9.53033C14.7626 9.82322 15.2374 9.82322 15.5303 9.53033L21.25 3.81066V7.85714C21.25 8.27136 21.5858 8.60714 22 8.60714C22.4142 8.60714 22.75 8.27136 22.75 7.85714V2C22.75 1.58579 22.4142 1.25 22 1.25H16.1429Z" fill="#1C274C"/>
            <path d="M7.85714 22.75C8.27136 22.75 8.60714 22.4142 8.60714 22C8.60714 21.5858 8.27136 21.25 7.85714 21.25H3.81066L9.53033 15.5303C9.82322 15.2374 9.82322 14.7626 9.53033 14.4697C9.23744 14.1768 8.76256 14.1768 8.46967 14.4697L2.75 20.1893V16.1429C2.75 15.7286 2.41421 15.3929 2 15.3929C1.58579 15.3929 1.25 15.7286 1.25 16.1429V22C1.25 22.4142 1.58579 22.75 2 22.75H7.85714Z" fill="#1C274C"/>
            </svg>
        </div>
      </div>
      <div class="w-1/3 flex flex-col justify-center items-center">
        <span *ngIf="isReceiver" class="font-bold text-black w-full truncate text-center">{{ getCallerName() }}</span>
        <span *ngIf="!isReceiver" class="font-bold text-black w-full truncate text-center">{{ getReceiverName() }}</span>
        <ng-container *ngIf="audioStatus | async as status">
          <span *ngIf="status !== 'Audio connected'" class="text-black mt-2 w-full truncate text-center">{{ status }}</span>
          <span *ngIf="status === 'Audio connected'" class="text-black font-bold mt-2 w-full truncate text-center">{{ formattedTime }}</span>
        </ng-container>
      </div>
      <div class="w-1/3 flex flex-row justify-center">
        <div class="rounded-full w-14 h-14 bg-[#D32F2F] flex items-center justify-center" (click)="endCall()">
          <svg fill="#d3d3d3" width="30px" height="30px" viewBox="0 0 56 56" xmlns="http://www.w3.org/2000/svg"><path d="M 28.0235 17.6055 C 17.8751 17.6055 8.3361 19.7383 3.5783 24.4961 C 1.4454 26.6524 .3439 29.2539 .4845 32.3945 C .5782 34.2929 1.1642 35.9805 2.2657 37.0820 C 3.1095 37.9258 4.2345 38.3945 5.5704 38.1836 L 14.2657 36.7070 C 15.5783 36.4961 16.4923 36.0976 17.0783 35.4883 C 17.8517 34.7383 18.0861 33.6133 18.0861 32.1367 L 18.1095 29.7695 C 18.1095 29.3945 18.2735 29.1133 18.4845 28.8789 C 18.7188 28.5976 19.0704 28.4805 19.3283 28.4102 C 20.9220 28.0351 24.1798 27.6836 28.0235 27.6836 C 31.8908 27.6836 35.1251 27.9648 36.7188 28.4336 C 36.9532 28.5039 37.2814 28.6445 37.5392 28.8789 C 37.7735 29.1133 37.9142 29.3711 37.9142 29.7461 L 37.9376 32.1367 C 37.9610 33.6133 38.1954 34.7383 38.9454 35.4883 C 39.5548 36.0976 40.4688 36.4961 41.7814 36.7070 L 50.3593 38.1602 C 51.7422 38.3945 52.9144 37.9024 53.8283 37.0117 C 54.9299 35.9336 55.5390 34.2695 55.5861 32.3711 C 55.6561 29.2070 54.4609 26.6055 52.3518 24.4961 C 47.5705 19.7383 38.1720 17.6055 28.0235 17.6055 Z"/></svg>
        </div>
      </div>
    </div>
  </div>
</ion-content>
